# ИНСТРУКЦИЯ ПО УСТАНОВКЕ И ЗАПУСКУ TELEGRAM-БОТА ДЛЯ ПЛАТЕЖЕЙ

## УСТАНОВКА НА WINDOWS

### Шаг 1: Установка Python 3.9
1. Скачайте Python 3.9 с официального сайта: https://www.python.org/downloads/release/python-3913/
   - Прокрутите вниз до раздела "Files" и выберите "Windows installer (64-bit)"
   - **ВАЖНО:** Во время установки поставьте галочку "Add Python 3.9 to PATH"

2. Проверьте установку Python. Откройте командную строку (нажмите Win+R, введите "cmd" и нажмите Enter), затем введите:
   ```
   python --version
   ```
   Вы должны увидеть что-то вроде "Python 3.9.13"

### Шаг 2: Скачивание проекта
1. Создайте новую папку для бота, например, C:\telegram-payment-bot
2. Скопируйте все файлы проекта в эту папку:
   - main.py
   - database.py
   - payments.py
   - receipts.py

### Шаг 3: Создание виртуального окружения
1. Откройте командную строку и перейдите в папку с проектом:
   ```
   cd C:\telegram-payment-bot
   ```

2. Создайте виртуальное окружение:
   ```
   python -m venv venv
   ```

3. Активируйте виртуальное окружение:
   ```
   venv\Scripts\activate
   ```
   После активации в начале строки появится (venv)

### Шаг 4: Установка зависимостей
Введите следующую команду для установки всех необходимых библиотек:
```
pip install python-telegram-bot==20.4 stripe==5.4.0 python-dotenv==1.0.0 reportlab==3.6.12
```

### Шаг 5: Настройка API ключей
1. Создайте файл .env в папке проекта (C:\telegram-payment-bot\.env)
2. Откройте файл в Блокноте и добавьте следующие строки:
   ```
   TELEGRAM_TOKEN=ваш_токен_телеграм_бота
   STRIPE_API_KEY=ваш_ключ_api_stripe
   ```

3. Чтобы получить TELEGRAM_TOKEN:
   - Найдите бота @BotFather в Telegram
   - Отправьте ему команду /newbot
   - Следуйте инструкциям для создания нового бота
   - Скопируйте полученный токен в файл .env

4. Чтобы получить STRIPE_API_KEY:
   - Зарегистрируйтесь на сайте Stripe (https://stripe.com)
   - В панели управления найдите раздел "Developers" и затем "API keys"
   - Скопируйте "Secret key" (начинается с sk_test_ для тестового режима)
   - Вставьте ключ в файл .env

### Шаг 6: Запуск бота
1. Убедитесь, что виртуальное окружение активировано (в начале строки должно быть (venv))
2. Введите команду:
   ```
   python main.py
   ```
3. Вы увидите сообщение "Бот запущен. Нажмите Ctrl+C для остановки."
4. Теперь бот работает и готов обрабатывать команды в Telegram

## УСТАНОВКА НА LINUX (Ubuntu/Debian)

### Шаг 1: Установка Python 3.9
1. Откройте терминал (Ctrl+Alt+T)
2. Выполните следующие команды:
   ```
   sudo apt update
   sudo apt install software-properties-common
   sudo add-apt-repository ppa:deadsnakes/ppa
   sudo apt update
   sudo apt install python3.9 python3.9-venv python3.9-dev
   ```

3. Проверьте установку:
   ```
   python3.9 --version
   ```

### Шаг 2: Скачивание проекта
1. Создайте папку для проекта:
   ```
   mkdir ~/telegram-payment-bot
   cd ~/telegram-payment-bot
   ```

2. Скопируйте все файлы проекта в эту папку:
   - main.py
   - database.py
   - payments.py
   - receipts.py

### Шаг 3: Создание виртуального окружения
1. Перейдите в папку с проектом (если вы еще не там):
   ```
   cd ~/telegram-payment-bot
   ```

2. Создайте виртуальное окружение:
   ```
   python3.9 -m venv venv
   ```

3. Активируйте его:
   ```
   source venv/bin/activate
   ```
   После активации в начале строки появится (venv)

### Шаг 4: Установка зависимостей
Введите следующую команду:
```
pip install python-telegram-bot==20.4 stripe==5.4.0 python-dotenv==1.0.0 reportlab==3.6.12
```

### Шаг 5: Настройка API ключей
1. Создайте файл .env:
   ```
   nano .env
   ```

2. Добавьте следующие строки:
   ```
   TELEGRAM_TOKEN=ваш_токен_телеграм_бота
   STRIPE_API_KEY=ваш_ключ_api_stripe
   ```

3. Сохраните файл: нажмите Ctrl+O, затем Enter, затем Ctrl+X

4. Получение TELEGRAM_TOKEN:
   - Найдите бота @BotFather в Telegram
   - Отправьте ему команду /newbot
   - Следуйте инструкциям для создания нового бота
   - Скопируйте полученный токен в файл .env

5. Получение STRIPE_API_KEY:
   - Зарегистрируйтесь на сайте Stripe (https://stripe.com)
   - В панели управления найдите раздел "Developers" и затем "API keys"
   - Скопируйте "Secret key" (начинается с sk_test_ для тестового режима)
   - Вставьте ключ в файл .env

### Шаг 6: Запуск бота
1. Убедитесь, что виртуальное окружение активировано (в начале строки должно быть (venv))
2. Введите команду:
   ```
   python main.py
   ```
3. Вы увидите сообщение "Бот запущен. Нажмите Ctrl+C для остановки."
4. Теперь бот работает и готов обрабатывать команды в Telegram

## ИСПОЛЬЗОВАНИЕ БОТА

1. Найдите своего бота в Telegram (по имени, которое вы указали при создании)
2. Отправьте команду `/start`, чтобы начать работу с ботом
3. Используйте команду `/pay`, чтобы создать новый платеж:
   - Введите сумму платежа
   - Введите описание платежа
   - Бот создаст платеж и отправит вам ссылку для оплаты
4. Используйте команду `/payments`, чтобы просмотреть историю платежей

## ДОПОЛНИТЕЛЬНАЯ ИНФОРМАЦИЯ

1. Если вы хотите, чтобы бот работал постоянно на сервере, изучите способы запуска скриптов в фоновом режиме (например, с использованием systemd на Linux или службы Windows на Windows).

2. Бот сохраняет все данные о платежах в файл базы данных SQLite (payments.db), который создается в папке проекта.

3. Если вы хотите использовать бота в производственной среде, не забудьте заменить тестовый API ключ Stripe на боевой (начинается с sk_live_).

## УСТРАНЕНИЕ ПРОБЛЕМ

1. Если Python не найден в командной строке Windows:
   - Убедитесь, что вы поставили галочку "Add Python 3.9 to PATH" при установке
   - Перезапустите командную строку

2. Если возникают ошибки при установке зависимостей:
   - Убедитесь, что вы используете Python 3.9
   - Попробуйте обновить pip: `python -m pip install --upgrade pip`

3. Если бот не запускается из-за ошибки с API ключами:
   - Проверьте, что файл .env находится в той же папке, что и main.py
   - Убедитесь, что в файле нет опечаток и лишних пробелов

4. Если бот запускается, но не отвечает в Telegram:
   - Проверьте, что вы правильно ввели токен Telegram
   - Убедитесь, что бот не был заблокирован пользователем
   - Попробуйте написать боту первым (/start)

5. Если возникают проблемы с платежами:
   - Проверьте, что API ключ Stripe действителен и активен
   - Убедитесь, что вы не используете кириллические символы в названии товара

При возникновении других проблем обратитесь к документации Python, python-telegram-bot и Stripe API.